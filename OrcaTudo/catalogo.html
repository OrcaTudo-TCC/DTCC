<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalogo de Fornecedores</title>
    <script src="https://kit.fontawesome.com/449a3898b7.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="css/catalogo.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="icon" href="imagens/Logo1.png" type="image/png">

</head>
<body>

    <header>
        <div class="logo">
            <img src="imagens/Logo1.png">
        </div>
        
        <div class="search-bar">
            <input type="text" placeholder="O que você procura na Orça tudo ?">
            <i class="fas fa-search"></i>
        </div>
        <nav>
            <ul>
                <li><a href="#">Dashboard</a></li>
                <li><a href="#">Licitação</a></li>
                <li><a href="#">Cotação</a></li>
                <li><a href="#">Sobre nós</a></li>
            </ul>
        </nav>
        <div class="icons">

            <div class="user-menu">
                <i class="far fa-user" id="user-icon"></i>
                <div class="dropdown-menu" id="dropdown-menu">
                    <a href="#">Configurações</a>
                    <a href="#">Sair da Conta</a>
                </div>
            </div>
           
           
            <i class="fas fa-shopping-cart"></i>
        </div>


        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const userIcon = document.getElementById("user-icon");
                const dropdownMenu = document.getElementById("dropdown-menu");
        
                userIcon.addEventListener("click", function (event) {
                    event.stopPropagation(); // Impede que o clique feche imediatamente
                    dropdownMenu.style.display = (dropdownMenu.style.display === "block") ? "none" : "block";
                });
        
                document.addEventListener("click", function () {
                    dropdownMenu.style.display = "none";
                });
        
                dropdownMenu.addEventListener("click", function (event) {
                    event.stopPropagation(); // Evita que o clique no menu feche ele
                });
            });
        </script>

    </header>
    

    <container>


        <div class="mainContent">


              

              <div id="main" >
                            <section class="ordenar-section">
                <span>Produtos em destaque</span>

              </section>
                <section class="catalogo-section">
                  <!-- Filtro -->
                  <div class="filtro-container">
                    <label for="filtro-categoria">Filtrar por Categoria</label>
                    <select id="filtro-categoria" class="filtro-selecao">
                      <!-- <option value="" disabled selected>Selecione uma categoria</option> -->
                    </select>
                  </div>

                  <div class="filtro-container">
                    <label for="filtro">Filtrar por Subcategoria</label>
                    <select id="filtro-subcategoria" class="filtro-selecao">
                      <option value="" disabled selected>Selecione subcategoria</option>
                    </select>
                  </div>

                  <div class="filtro-container">
                    <label for="filtro">Filtrar por Categoria Específica</label>
                    <select id="filtro-final" class="filtro-selecao">
                      <option value="" disabled selected>Selecione categoria final</option>
                    </select>
                  </div>
                
                
    
                    
                </section>
                <div class="results">12345 Resultados encontrados</div>
                <section class="produto-section">
                  <div class="produto-card">
                      <img src="https://cdn.leroymerlin.com.br/products/carrinho_de_mao_em_aco_carbono_pneu_e_camara_chapa_26mm_45l_1571958082_5aac_300x300.jpg" alt="Produto" />
                      <h3> Carrinho De Mão Em Aço </h3>
                      <p class="preco">R$ 189,91</p>
                      <p class="categoria"> Ferramentas e Equipamentos</p>
                      <p class="subcategoria">Carrinhos de Mão</p>
                    </div>
                    
              
                  <!-- repete os cards -->
                  
                  <div class="produto-card">
                    <img src="https://cdn.leroymerlin.com.br/products/betoneira_400l_1_traco_max_mono_127v_csm_92016435_f57f_600x600.jpg" alt="Produto" />
                    <h3> Betoneira 400L 1 Traço </h3>
                    <p class="preco">R$ 4.589,00</p>
                    <p class="categoria"> Categoria </p>
                    <p class="subcategoria"> Sub Categoria </p>
                  </div>
                  
                  <div class="produto-card">
                    <img src="https://cdn.leroymerlin.com.br/products/trena_manual_5mx19mm_460610_dexter_91716401_b391_600x600.jpg" alt="Produto" />
                    <h3> Trena Manual 5 metros </h3>
                    <p class="preco">R$  29,90</p>
                    <p class="categoria"> Categoria </p>
                    <p class="subcategoria"> Sub Categoria </p>
                  </div>
                  
                  <div class="produto-card">
                    <img src="imagens/placeholder.jpg" alt="Produto" />
                    <h3> Nome Produto  </h3>
                    <p class="preco">R$ 00,00</p>
                    <p class="categoria"> Categoria </p>
                    <p class="subcategoria"> Sub Categoria </p>
                  </div>
                  
                  <div class="produto-card">
                    <img src="imagens/placeholder.jpg" alt="Produto" />
                    <h3> Nome Produto  </h3>
                    <p class="preco">R$ 00,00</p>
                    <p class="categoria"> Categoria </p>
                    <p class="subcategoria"> Sub Categoria </p>
                  </div>
                  
                  <div class="produto-card">
                    <img src="imagens/placeholder.jpg" alt="Produto" />
                    <h3> Nome Produto  </h3>
                    <p class="preco">R$ 00,00</p>
                    <p class="categoria"> Categoria </p>
                    <p class="subcategoria"> Sub Categoria </p>
                  </div>
                  
                  <div class="produto-card">
                    <img src="imagens/placeholder.jpg" alt="Produto" />
                    <h3> Nome Produto  </h3>
                    <p class="preco">R$ 00,00</p>
                    <p class="categoria"> Categoria </p>
                    <p class="subcategoria"> Sub Categoria </p>
                  </div>
                  
                  <div class="produto-card">
                    <img src="imagens/placeholder.jpg" alt="Produto" />
                    <h3> Nome Produto  </h3>
                    <p class="preco">R$ 00,00</p>
                    <p class="categoria"> Categoria </p>
                    <p class="subcategoria"> Sub Categoria </p>
                  </div>
                  
                  <div class="produto-card">
                    <img src="imagens/placeholder.jpg" alt="Produto" />
                    <h3> Nome Produto  </h3>
                    <p class="preco">R$ 00,00</p>
                    <p class="categoria"> Categoria </p>
                    <p class="subcategoria"> Sub Categoria </p>
                  </div>
                  

                  
                </section>
              </div>

              
    </container>



    <footer>
      <div class="footer-container">
          <div class="footer-section">
              <img src="imagens/Logo.png" alt="OrçaTudo Logo" class="footer-logo">
          </div>
          <div class="footer-section">
              <h3>Ideal Para</h3>
              <ul>
                  <li>Engenheiros Civis</li>
                  <li>Construtoras</li>
                  <li>Orçamentistas</li>
              </ul>
          </div>
          <div class="footer-section">
              <h3>Funcionalidades</h3>
              <ul>
                  <li>Cotação de Preços</li>
                  <li>Gestão de Orçamentos</li>
                  <li>Comparação de Materiais</li>
              </ul>
          </div>
          <div class="footer-section">
              <h3>Recursos</h3>
              <ul>
                  <li>Lista de Fornecedores</li>
                  <li>Simulação de Custos</li>
                  <li>Dashboard Interativo</li>
              </ul>
          </div>
          <div class="footer-section">
              <h3>Sobre</h3>
              <ul>
                  <li><a href="#">Sobre o OrçaTudo</li>
                  <li><a href="#">Contato</a></li>
              </ul>
          </div>
      </div>
      <div class="footer-bottom">
          <p>© 2025 OrçaTudo. Todos os direitos reservados | Política de Privacidade | Termos de Serviço</p>
      </div>
  </footer>
  

  <script src="js/categoria.js" ></script>
  <script src="js/subcategoria.js"></script>
  <script src="js/SubcategoriaFinal.js"></script>
  <script src="js/produto.js"></script>
  <!--Script responsável por realizar integração das categorias(principal)-->
  <script>
      const select = document.getElementById('filtro-categoria');
      const selectSub = document.getElementById('filtro-subcategoria');
      const selectFinal = document.getElementById('filtro-final');

    
    document.addEventListener('DOMContentLoaded', async ()=>{
      await inicializarSelects()

      let produtos = await todosProdutos();
    })
  </script>

  <!--Scrpit para renderizar produtos-->
  <script>
    function renderizarProdutos(produtos){
      produtos.forEach(produto =>{

        let  div = document.createElement('div');
        div.classList.add('produto-card');
        let img = document.createElement('img');
        img.src = "imagens/placeholder.jpg";
        let h3Nome = document.createElement('h3');
        h3Nome.innerText = produto.nome;
        let preco = document.createElement('p');
        preco.classList.add('preco');
        let categoria = document.createElement('p');
        categoria.classList.add('categoria');
        categoria.innerText = produto.subcategoriafinal.nome;

      })

    }

 </script>

  <!--script responsável por buscar todos os produtos ao inicar página-->
  <script>
    async function todosProdutos() {
      let categorias = getCategoria();
      let subcategorias = Promise.all(categorias.map(cate => getSubcategoria(cate.nome)));
      let categoriasFinal = Promise.all(
        subcategorias.flat().map(sub => getSubcategoriafinal(sub.nome))
      );
      let produtos = Promise.all(
        categoriasFinal.flat().map(final => getProdutoByCategoriaFinal(final.nome))
      );
      return produtos.flat();
    }


  </script>
  <!--Script responsável pela inicialização dos selects-->
  <script>
    async function inicializarSelects() {
      let categorias;
      let subcategorias;
      let categoriasFinal;
      categorias = await getCategoria();
      console.log(categorias)

      //colocando as categorias existentes na página
      optionSelected= document.createElement('option');
      optionSelected.value = '';
      optionSelected.disabled = true;
      optionSelected.selected = true;
      optionSelected.innerText = 'Selecione uma categoria';
      select.appendChild(optionSelected);
      categorias.forEach(categoria => {
        option = document.createElement('option');
        option.value = categoria.nome;
        option.innerText = categoria.nome;
        select.appendChild(option);
      });

      //Adicionando eventListener para realizar nova busca quando é alterado o valor do select categoria
      select.addEventListener('change', async ()=>{
        //resetando o conteúdo dos selects dependentes
        selectSub.innerHTML = '<option value= "" disabled selected>Selecione subcategoria</option>';
        selectFinal.innerHTML = '<option value="" disabled selected>Selecione categoria final</option>';
        if(!select.value !== "" ){
          subcategorias = await getSubcategoria(select.value);
          console.log(subcategorias);
          subcategorias.forEach(subcategoria => {
  
            option = document.createElement('option');
            option.value = subcategoria.nome;
            option.innerText = subcategoria.nome;
            selectSub.appendChild(option);
          })
        }
        //realizando consulta com o novo valor de select
      })

      //Adicionando eventListener para realizar busca quando ocorrer alteração subcategoria
      selectSub.addEventListener('change', async ()=>{
        selectFinal.innerHTML = '<option value="" disabled selected>Selecione categoria final</option>';
        if(!selectSub.value !== ""){

          categoriasFinal = await getSubcategoriafinal(selectSub.value);
          console.log(categoriasFinal)
          categoriasFinal.forEach(final => {
          
          option = document.createElement('option');
          option.value = final.nome;
          option.innerText = final.nome;
          selectFinal.appendChild(option);
        })
        }
      })
    }
  </script>



</body>
</html>

