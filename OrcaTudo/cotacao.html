<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotação</title>
    <script src="https://kit.fontawesome.com/449a3898b7.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/cotacao.css">
    <link rel="icon" href="imagens/Logo1.png" type="image/png">
</head>
<body>


    <header>
        <div class="logo">
            <img src="imagens/Logo1.png">
        </div>
        
        <div class="search-bar">
            <input type="text" placeholder="O que você procura na Orça tudo ?">
            <i class="fas fa-search"></i>
        </div>
        <nav>
            <ul>
                <li><a href="#">Dashboard</a></li>
                <li><a href="#">Licitação</a></li>
                <li><a href="#">Cotação</a></li>
                <li><a href="#">Sobre nós</a></li>
            </ul>
        </nav>
        <div class="icons">

            <div class="user-menu">
                <i class="far fa-user" id="user-icon"></i>
                <div class="dropdown-menu" id="dropdown-menu">
                    <a href="#">Configurações</a>
                    <a href="#">Sair da Conta</a>
                </div>
            </div>
           
           
            <i class="fas fa-shopping-cart"></i>
        </div>


        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const userIcon = document.getElementById("user-icon");
                const dropdownMenu = document.getElementById("dropdown-menu");
        
                userIcon.addEventListener("click", function (event) {
                    event.stopPropagation(); // Impede que o clique feche imediatamente
                    dropdownMenu.style.display = (dropdownMenu.style.display === "block") ? "none" : "block";
                });
        
                document.addEventListener("click", function () {
                    dropdownMenu.style.display = "none";
                });
        
                dropdownMenu.addEventListener("click", function (event) {
                    event.stopPropagation(); // Evita que o clique no menu feche ele
                });
            });
        </script>

    </header>

    <container>
        <section class="conteudo">
            <div class="produto-container">
                <div class="imagem-produto">
                    <img src="imagens/placeholder.jpg" alt="Imagem do Produto">
                </div>
                
                <div class="detalhes-produto">
                    <h1 class="produto-titulo">Betoneira 400L Prime 220V Menegotti</h1>
                    
                    <div class="cotacao">
                        <div class="linha">
                            <div class="campo">
                                <label for="categoria">Categoria</label>
                                <!-- <input type="text" id="categoria" placeholder="Ex: Betoneira"> -->
                                <h3 id="categoria" >Betoneira</h3>
                            </div>
                
                            <div class="campo">
                                <label for="subcategoria">Subcategoria</label>
                                <!-- <input type="text" id="subcategoria" placeholder="Ex: Prime 220V"> -->
                                <h3 id="subcategoria" >Betoneira 400L</h3>
                            </div>
                        </div>
                
                        <div class="campo">
                            <label for="produto">Produto</label>
                            <!-- <input type="text" id="produto" placeholder="Betoneira 400L Prime 220V Menegotti"> -->
                            <h3 id="produto">Betoneira 400L Prime 220V Menegotti</h3>
                        </div>
                    </div>
                    
                    <div class="descricao-produto">
                        <h2>Descrição do Produto</h2>
                        <ul>
                            <li><strong>Capacidade:</strong> 400L no tambor, ideal para pequenos projetos.</li>
                            <li><strong>Funcionamento:</strong> Energia elétrica, 220V, motor de 2CV.</li>
                            <li><strong>Produção horária:</strong> 4.65 m³/h, garantindo eficiência.</li>
                            <li><strong>Mobilidade:</strong> Compacta e fácil de transportar, com rodas.</li>
                            <li><strong>Durabilidade:</strong> Alta resistência e longa vida útil.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section class="tabela">
            <div class="tabela-container">
                <table class="tabela-content">
                    <thead>
                        <tr>
                            <th>Fornecedor</th>
                            <th>Preço</th>
                            <th>Distância</th>
                            <th>Frete</th>
                            <th>Marca</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Fornecedor A</td>
                            <td>R$ 1.500,00</td>
                            <td>20 km</td>
                            <td>R$ 50,00</td>
                            <td>Marca X</td>
                        </tr>
                        <tr>
                            <td>Fornecedor B</td>
                            <td>R$ 1.450,00</td>
                            <td>15 km</td>
                            <td>R$ 45,00</td>
                            <td>Marca Y</td>
                        </tr>
                        <tr>
                            <td>Fornecedor C</td>
                            <td>R$ 1.600,00</td>
                            <td>30 km</td>
                            <td>R$ 60,00</td>
                            <td>Marca Z</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>


        <section class="compra">
            <div class="compra-container">
                <p><strong>Produto selecionado:</strong></p>
                <input type="text" id="produto-selecionado" placeholder="Betoneira 400L Prime 220V Menegotti" disabled>
        
                <div class="quantidade-subtotal">
                    <div class="quantidade">
                        <label for="quantidade"><strong>Quantidade:</strong></label>
                        <input type="number" id="quantidade" min="1" value="1">
                    </div>
                    <div class="subtotal">
                        <label for="subtotal"><strong>Subtotal:</strong></label>
                        <input type="text" id="subtotal" disabled>
                    </div>
                </div>
        
                <div class="botoes-compra">
                    <button class="btn verde">Adicionar ao carrinho</button>
                    <button class="btn verde">Comprar</button>
                    <button class="btn azul">Iniciar licitação</button>
                </div>
            </div>
        </section>

    </container>


    <footer>
        <div class="footer-container">
            <div class="footer-section">
                <img src="imagens/Logo.png" alt="OrçaTudo Logo" class="footer-logo">
            </div>
            <div class="footer-section">
                <h3>Ideal Para</h3>
                <ul>
                    <li>Engenheiros Civis</li>
                    <li>Construtoras</li>
                    <li>Orçamentistas</li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Funcionalidades</h3>
                <ul>
                    <li>Cotação de Preços</li>
                    <li>Gestão de Orçamentos</li>
                    <li>Comparação de Materiais</li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Recursos</h3>
                <ul>
                    <li>Lista de Fornecedores</li>
                    <li>Simulação de Custos</li>
                    <li>Dashboard Interativo</li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Sobre</h3>
                <ul>
                    <li><a href="#">Sobre o OrçaTudo</li>
                    <li><a href="#">Contato</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2025 OrçaTudo. Todos os direitos reservados | Política de Privacidade | Termos de Serviço</p>
        </div>
    </footer>

    <!--integração da página-->
    <script src="js/produto.js"></script>

    <script>
        const param = new URLSearchParams(window.location.search);
        const produtostr =  parseInt(param.get('produto'));
        if(produtoStr === null || isNaN(parseInt(produtoStr))){
            alert("Parámetro 'produto' ausente ou inválido");
        }else{
            const idProduto = parseInt(produtostr);
            console.log("id do produto: ",idProduto)
        }
        document.addEventListener("DOMContentLoaded", async () => {
            carregarProduto(idProduto);
        } )
    </script>
    

    <script>

        async function carregarProduto(idProduto) {
            produto = await getProdutoById(idProduto);
            console.log(produto)

            let imgContainer = document.getElementsByClassName('imagem-produto')[0];
            let imgElement = imgContainer.firstElementChild();
            let Nomeh1 = document.getElementsByClassName('produto-titulo')[0];
            let categoriaH3 = document.getElementById('categoria');
            let subcategoriaH3 = document.getElementById('subcategoria');
            let categoriaFinal = document.getElementById('produto');
            let descriçãoDiv = document.getElementsByClassName('descricao-produto')[0];


            

            Nomeh1.innerText = produto.nome;
            categoriaH3.innerText = produto.subcategoriaFinal.subcategoria.categoria.nome;
            subcategoriaH3.innerText = produto.subcategoriaFinal.subcategoria.nome;
            categoriaFinal.innerText = produto.subcategoriaFinal.nome;
            //definindo a imagem do produto.
            const base64 = produto.imagem;
            const contentType = "image/png"; // ou "image/jpeg", conforme o caso
            const dataUrl = `data:${contentType};base64,${base64}`;
            imgElement.src = dataUrl;

            

        }
    </script>
</body>
</html>
